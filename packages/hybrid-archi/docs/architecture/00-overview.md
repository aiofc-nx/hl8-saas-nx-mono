# hybrid-archi æ¶æ„æ¦‚è¿°

> **æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2025-01-27  
> **æ–‡æ¡£ç±»å‹**: æ¶æ„è®¾è®¡æ–‡æ¡£  

---

## ğŸ“‹ ç›®å½•

- [1. æ¨¡å—å®šä½](#1-æ¨¡å—å®šä½)
- [2. æ¶æ„æ„¿æ™¯](#2-æ¶æ„æ„¿æ™¯)
- [3. æ··åˆæ¶æ„æ¨¡å¼](#3-æ··åˆæ¶æ„æ¨¡å¼)
- [4. æ¶æ„åˆ†å±‚](#4-æ¶æ„åˆ†å±‚)
- [5. æ ¸å¿ƒç»„ä»¶](#5-æ ¸å¿ƒç»„ä»¶)
- [6. è®¾è®¡åŸåˆ™](#6-è®¾è®¡åŸåˆ™)
- [7. æŠ€æœ¯æ ˆ](#7-æŠ€æœ¯æ ˆ)
- [8. æ¶æ„å›¾](#8-æ¶æ„å›¾)

---

## 1. æ¨¡å—å®šä½

### 1.1 æ ¸å¿ƒå®šä½

> ğŸ¯ **hybrid-archi æ˜¯æ•´ä¸ª HL8 SAAS å¹³å°çš„æ¶æ„åŸºçŸ³**

`hybrid-archi` æ˜¯ HL8 SAAS å¹³å°çš„**æ ¸å¿ƒæ¶æ„åŸºç¡€æ¨¡å—**ï¼Œä¸ºæ•´ä¸ªå¹³å°æä¾›ç»Ÿä¸€çš„æ¶æ„è®¾è®¡æ¨¡å¼å’Œå®Œæ•´çš„é€šç”¨åŠŸèƒ½ç»„ä»¶ã€‚

### 1.2 æ ¸å¿ƒç›®æ ‡

#### ç›®æ ‡ 1: ç»Ÿä¸€æ¶æ„æ¨¡å¼

ä¸ºæ‰€æœ‰ä¸šåŠ¡æ¨¡å—æä¾›ç»Ÿä¸€çš„æ··åˆæ¶æ„è®¾è®¡æ¨¡å¼ï¼Œç¡®ä¿ï¼š

- âœ… æ¶æ„ä¸€è‡´æ€§ï¼šæ‰€æœ‰æ¨¡å—ä½¿ç”¨ç›¸åŒçš„æ¶æ„é£æ ¼
- âœ… å¼€å‘æ•ˆç‡ï¼šç»Ÿä¸€æ¨¡å¼é™ä½å­¦ä¹ æ›²çº¿
- âœ… ä»£ç è´¨é‡ï¼šç»Ÿä¸€è§„èŒƒæå‡ä»£ç è´¨é‡
- âœ… å¯ç»´æŠ¤æ€§ï¼šä¸€è‡´çš„ç»“æ„ä¾¿äºç»´æŠ¤

#### ç›®æ ‡ 2: æä¾›é€šç”¨åŠŸèƒ½ç»„ä»¶

æä¾›æ··åˆæ¶æ„å¼€å‘æ‰€éœ€çš„å®Œæ•´é€šç”¨åŠŸèƒ½ç»„ä»¶ï¼š

- âœ… **é¢†åŸŸå±‚ç»„ä»¶**ï¼šBaseEntityã€BaseAggregateRootã€BaseValueObjectã€BaseDomainEvent
- âœ… **åº”ç”¨å±‚ç»„ä»¶**ï¼šCommandBusã€QueryBusã€EventBusã€IUseCase
- âœ… **åŸºç¡€è®¾æ–½ç»„ä»¶**ï¼šä»“å‚¨é€‚é…å™¨ã€äº‹ä»¶å­˜å‚¨ã€ç«¯å£é€‚é…å™¨
- âœ… **æ¥å£å±‚ç»„ä»¶**ï¼šBaseControllerã€å®ˆå«ã€è£…é¥°å™¨ã€ä¸­é—´ä»¶

#### ç›®æ ‡ 3: ä½œä¸ºä¸šåŠ¡æ¨¡å—åŸºç¡€

æ‰€æœ‰ä¸šåŠ¡æ¨¡å—å¿…é¡»åŸºäº hybrid-archi å¼€å‘ï¼š

- âœ… ä¸šåŠ¡æ¨¡å—ç›´æ¥ç»§æ‰¿å’Œä½¿ç”¨ hybrid-archi çš„åŸºç¡€ç»„ä»¶
- âœ… ä¸šåŠ¡æ¨¡å—éµå¾ª hybrid-archi å®šä¹‰çš„æ¶æ„æ¨¡å¼
- âœ… ä¸šåŠ¡æ¨¡å—å¤ç”¨ hybrid-archi çš„é€šç”¨åŠŸèƒ½
- âœ… ä¸šåŠ¡æ¨¡å—ä¸åç¦» hybrid-archi çš„æ¶æ„è®¾è®¡

### 1.3 æ¨¡å—èŒè´£

```
hybrid-archi èŒè´£èŒƒå›´
â”œâ”€â”€ 1. å®šä¹‰æ¶æ„æ¨¡å¼
â”‚   â”œâ”€â”€ Clean Architecture åˆ†å±‚
â”‚   â”œâ”€â”€ DDD å……è¡€æ¨¡å‹
â”‚   â”œâ”€â”€ CQRS å‘½ä»¤æŸ¥è¯¢åˆ†ç¦»
â”‚   â”œâ”€â”€ Event Sourcing äº‹ä»¶æº¯æº
â”‚   â””â”€â”€ Event-Driven Architecture äº‹ä»¶é©±åŠ¨
â”‚
â”œâ”€â”€ 2. æä¾›åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ é¢†åŸŸå±‚ï¼šå®ä½“ã€èšåˆæ ¹ã€å€¼å¯¹è±¡ã€äº‹ä»¶
â”‚   â”œâ”€â”€ åº”ç”¨å±‚ï¼šç”¨ä¾‹ã€CQRSæ€»çº¿ã€æœåŠ¡
â”‚   â”œâ”€â”€ åŸºç¡€è®¾æ–½å±‚ï¼šé€‚é…å™¨ã€å·¥å‚ã€äº‹ä»¶å­˜å‚¨
â”‚   â””â”€â”€ æ¥å£å±‚ï¼šæ§åˆ¶å™¨ã€å®ˆå«ã€è£…é¥°å™¨
â”‚
â”œâ”€â”€ 3. é›†æˆåŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ å¤šç§Ÿæˆ·ï¼ˆ@hl8/multi-tenancyï¼‰
â”‚   â”œâ”€â”€ ç¼“å­˜ï¼ˆ@hl8/cacheï¼‰
â”‚   â”œâ”€â”€ æ—¥å¿—ï¼ˆ@hl8/loggerï¼‰
â”‚   â”œâ”€â”€ é…ç½®ï¼ˆ@hl8/configï¼‰
â”‚   â”œâ”€â”€ æ•°æ®åº“ï¼ˆ@hl8/databaseï¼‰
â”‚   â”œâ”€â”€ æ¶ˆæ¯ï¼ˆ@hl8/messagingï¼‰
â”‚   â”œâ”€â”€ Webæ¡†æ¶ï¼ˆ@hl8/fastify-proï¼‰
â”‚   â””â”€â”€ é€šç”¨å·¥å…·ï¼ˆ@hl8/commonã€@hl8/utilsï¼‰
â”‚
â””â”€â”€ 4. å®šä¹‰å¼€å‘è§„èŒƒ
    â”œâ”€â”€ ä»£ç è§„èŒƒ
    â”œâ”€â”€ æµ‹è¯•è§„èŒƒ
    â”œâ”€â”€ æ³¨é‡Šè§„èŒƒ
    â””â”€â”€ æ¶æ„è§„èŒƒ
```

---

## 2. æ¶æ„æ„¿æ™¯

### 2.1 æ„¿æ™¯å£°æ˜

> **æ„å»ºä¸€ä¸ªé«˜è´¨é‡ã€é«˜å¯ç»´æŠ¤ã€é«˜å¯æ‰©å±•çš„ä¼ä¸šçº§ SAAS å¹³å°æ¶æ„åŸºç¡€**

### 2.2 æ¶æ„ç›®æ ‡

#### ç›®æ ‡ 1: é«˜å†…èšã€ä½è€¦åˆ

- æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- æ˜ç¡®çš„ä¾èµ–æ–¹å‘
- æ¥å£éš”ç¦»åŸåˆ™
- ä¾èµ–å€’ç½®åŸåˆ™

#### ç›®æ ‡ 2: ä¸šåŠ¡é©±åŠ¨

- å……è¡€æ¨¡å‹è®¾è®¡
- é¢†åŸŸé©±åŠ¨è®¾è®¡
- ä¸šåŠ¡è§„åˆ™å°è£…
- ä¸šåŠ¡è¯­è¨€è¡¨è¾¾

#### ç›®æ ‡ 3: å¯æµ‹è¯•æ€§

- ä¾èµ–æ³¨å…¥
- æ¥å£æŠ½è±¡
- Mock å‹å¥½
- æµ‹è¯•éš”ç¦»

#### ç›®æ ‡ 4: å¯æ‰©å±•æ€§

- æ’ä»¶åŒ–è®¾è®¡
- äº‹ä»¶é©±åŠ¨
- å¼‚æ­¥å¤„ç†
- æ°´å¹³æ‰©å±•

#### ç›®æ ‡ 5: é«˜æ€§èƒ½

- CQRS è¯»å†™åˆ†ç¦»
- äº‹ä»¶å¼‚æ­¥å¤„ç†
- ç¼“å­˜ç­–ç•¥
- è¿æ¥æ± ç®¡ç†

---

## 3. æ··åˆæ¶æ„æ¨¡å¼

### 3.1 äº”å¤§æ¶æ„æ¨¡å¼èåˆ

hybrid-archi é‡‡ç”¨æ··åˆæ¶æ„æ¨¡å¼ï¼Œæœ‰æœºèåˆäº”ç§å¼ºå¤§çš„æ¶æ„æ¨¡å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Hybrid Architecture                        â”‚
â”‚                          æ··åˆæ¶æ„æ¨¡å¼                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€ Clean Architecture (æ•´æ´æ¶æ„)
         â”‚    â”‚
         â”‚    â”œâ”€ æä¾›ï¼šæ¸…æ™°çš„åˆ†å±‚æ¶æ„å’Œä¾èµ–æ–¹å‘
         â”‚    â”œâ”€ æ ¸å¿ƒï¼šä¾èµ–å€’ç½®åŸåˆ™ (DIP)
         â”‚    â””â”€ ä»·å€¼ï¼šä¸šåŠ¡é€»è¾‘ç‹¬ç«‹äºæŠ€æœ¯ç»†èŠ‚
         â”‚
         â”œâ”€â”€â”€ Domain-Driven Design (é¢†åŸŸé©±åŠ¨è®¾è®¡)
         â”‚    â”‚
         â”‚    â”œâ”€ æä¾›ï¼šå……è¡€æ¨¡å‹å’Œé¢†åŸŸå»ºæ¨¡
         â”‚    â”œâ”€ æ ¸å¿ƒï¼šå®ä½“ã€èšåˆæ ¹ã€å€¼å¯¹è±¡
         â”‚    â””â”€ ä»·å€¼ï¼šä¸šåŠ¡å¤æ‚åº¦ç®¡ç†
         â”‚
         â”œâ”€â”€â”€ CQRS (å‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»)
         â”‚    â”‚
         â”‚    â”œâ”€ æä¾›ï¼šè¯»å†™åˆ†ç¦»
         â”‚    â”œâ”€ æ ¸å¿ƒï¼šCommandBusã€QueryBus
         â”‚    â””â”€ ä»·å€¼ï¼šæ€§èƒ½å’Œå¯æ‰©å±•æ€§
         â”‚
         â”œâ”€â”€â”€ Event Sourcing (äº‹ä»¶æº¯æº)
         â”‚    â”‚
         â”‚    â”œâ”€ æä¾›ï¼šäº‹ä»¶å­˜å‚¨å’ŒçŠ¶æ€é‡å»º
         â”‚    â”œâ”€ æ ¸å¿ƒï¼šEventStoreã€Snapshot
         â”‚    â””â”€ ä»·å€¼ï¼šå®¡è®¡è¿½è¸ªå’Œæ—¶é—´æ—…è¡Œ
         â”‚
         â””â”€â”€â”€ Event-Driven Architecture (äº‹ä»¶é©±åŠ¨æ¶æ„)
              â”‚
              â”œâ”€ æä¾›ï¼šå¼‚æ­¥é€šä¿¡å’Œè§£è€¦
              â”œâ”€ æ ¸å¿ƒï¼šEventBusã€EventHandler
              â””â”€ ä»·å€¼ï¼šç³»ç»Ÿè§£è€¦å’Œå¼¹æ€§
```

### 3.2 æ¶æ„æ¨¡å¼åä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Clean Architecture: å®šä¹‰åˆ†å±‚å’Œä¾èµ–æ–¹å‘                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  DDD: å®šä¹‰é¢†åŸŸæ¨¡å‹      â”‚
    â”‚  - å®ä½“                 â”‚
    â”‚  - èšåˆæ ¹               â”‚
    â”‚  - å€¼å¯¹è±¡               â”‚
    â”‚  - é¢†åŸŸäº‹ä»¶             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CQRS: åˆ†ç¦»è¯»å†™èŒè´£     â”‚
    â”‚  - å‘½ä»¤ç«¯ï¼ˆå†™ï¼‰         â”‚
    â”‚  - æŸ¥è¯¢ç«¯ï¼ˆè¯»ï¼‰         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ES: äº‹ä»¶æº¯æº           â”‚
    â”‚  - äº‹ä»¶å­˜å‚¨             â”‚
    â”‚  - çŠ¶æ€é‡å»º             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  EDA: äº‹ä»¶é©±åŠ¨          â”‚
    â”‚  - å¼‚æ­¥å¤„ç†             â”‚
    â”‚  - ç³»ç»Ÿè§£è€¦             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æ¶æ„åˆ†å±‚

### 4.1 å››å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Interface Layer (æ¥å£å±‚)                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  - REST Controllers                                       â”‚
â”‚  - GraphQL Resolvers                                      â”‚
â”‚  - WebSocket Gateways                                     â”‚
â”‚  - CLI Commands                                           â”‚
â”‚  - Guards & Middleware                                    â”‚
â”‚                                                           â”‚
â”‚  èŒè´£ï¼šå¤„ç†å¤–éƒ¨è¯·æ±‚ï¼Œè½¬æ¢ä¸ºåº”ç”¨å±‚å‘½ä»¤/æŸ¥è¯¢                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ depends on â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Application Layer (åº”ç”¨å±‚)                                â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  - Use Cases (ç”¨ä¾‹)                                        â”‚
â”‚  - Command Handlers (å‘½ä»¤å¤„ç†å™¨)                           â”‚
â”‚  - Query Handlers (æŸ¥è¯¢å¤„ç†å™¨)                             â”‚
â”‚  - Event Handlers (äº‹ä»¶å¤„ç†å™¨)                             â”‚
â”‚  - Sagas (åˆ†å¸ƒå¼äº‹åŠ¡ç¼–æ’)                                   â”‚
â”‚  - Application Services (åº”ç”¨æœåŠ¡)                         â”‚
â”‚                                                           â”‚
â”‚  èŒè´£ï¼šåè°ƒé¢†åŸŸå¯¹è±¡å®Œæˆä¸šåŠ¡ç”¨ä¾‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ depends on â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Domain Layer (é¢†åŸŸå±‚) - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘                       â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  - Entities (å®ä½“)                                         â”‚
â”‚  - Aggregate Roots (èšåˆæ ¹)                                â”‚
â”‚  - Value Objects (å€¼å¯¹è±¡)                                  â”‚
â”‚  - Domain Events (é¢†åŸŸäº‹ä»¶)                                â”‚
â”‚  - Domain Services (é¢†åŸŸæœåŠ¡)                              â”‚
â”‚  - Repository Interfaces (ä»“å‚¨æ¥å£)                        â”‚
â”‚  - Business Rules (ä¸šåŠ¡è§„åˆ™)                               â”‚
â”‚                                                           â”‚
â”‚  èŒè´£ï¼šåŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œç‹¬ç«‹äºæŠ€æœ¯å®ç°                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ implements â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  - Repository Implementations (ä»“å‚¨å®ç°)                   â”‚
â”‚  - Database Adapters (æ•°æ®åº“é€‚é…å™¨)                        â”‚
â”‚  - Cache Adapters (ç¼“å­˜é€‚é…å™¨)                             â”‚
â”‚  - Message Queue Adapters (æ¶ˆæ¯é˜Ÿåˆ—é€‚é…å™¨)                 â”‚
â”‚  - Event Store (äº‹ä»¶å­˜å‚¨)                                  â”‚
â”‚  - External Service Clients (å¤–éƒ¨æœåŠ¡å®¢æˆ·ç«¯)               â”‚
â”‚                                                           â”‚
â”‚  èŒè´£ï¼šå®ç°æŠ€æœ¯ç»†èŠ‚ï¼Œé€‚é…å¤–éƒ¨ç³»ç»Ÿ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ä¾èµ–è§„åˆ™

```
æ ¸å¿ƒä¾èµ–åŸåˆ™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¾èµ–å€’ç½®åŸåˆ™ (Dependency Inversion Principle)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½ä¾èµ–æŠ½è±¡          â”‚
â”‚  2. æŠ½è±¡ä¸ä¾èµ–å…·ä½“ï¼Œå…·ä½“ä¾èµ–æŠ½è±¡                   â”‚
â”‚  3. ä¾èµ–æ–¹å‘ï¼šå¤–å±‚â†’å†…å±‚                           â”‚
â”‚  4. ç¨³å®šæ€§æ–¹å‘ï¼šå…·ä½“â†’æŠ½è±¡                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¾èµ–æ–¹å‘ï¼š
  Interface â†’ Application â†’ Domain â† Infrastructure
     (å¤–å±‚)      (å¤–å±‚)      (æ ¸å¿ƒ)      (å¤–å±‚)
```

**ä¸¥æ ¼ç¦æ­¢**ï¼š

- âŒ Domain å±‚ä¾èµ– Application å±‚
- âŒ Domain å±‚ä¾èµ– Infrastructure å±‚
- âŒ Application å±‚ä¾èµ– Infrastructure å±‚çš„å…·ä½“å®ç°
- âŒ ä»»ä½•å†…å±‚ä¾èµ–å¤–å±‚

---

## 5. æ ¸å¿ƒç»„ä»¶

### 5.1 é¢†åŸŸå±‚æ ¸å¿ƒç»„ä»¶

#### BaseEntity - åŸºç¡€å®ä½“

```typescript
/**
 * åŸºç¡€å®ä½“
 * 
 * ç‰¹ç‚¹ï¼š
 * - å…·æœ‰å”¯ä¸€æ ‡è¯†ç¬¦
 * - ç”Ÿå‘½å‘¨æœŸç®¡ç†
 * - å®¡è®¡ä¿¡æ¯ï¼ˆåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤æ—¶é—´ç­‰ï¼‰
 * - å¤šç§Ÿæˆ·æ”¯æŒ
 */
export abstract class BaseEntity {
  protected constructor(
    private readonly _id: EntityId,
    private readonly _auditInfo: IAuditInfo
  ) {}
  
  // ç›¸ç­‰æ€§åŸºäº ID
  equals(other: BaseEntity): boolean;
  
  // å®¡è®¡ä¿¡æ¯
  get createdAt(): Date;
  get updatedAt(): Date;
  get deletedAt(): Date | null;
}
```

#### BaseAggregateRoot - åŸºç¡€èšåˆæ ¹

```typescript
/**
 * åŸºç¡€èšåˆæ ¹
 * 
 * ç‰¹ç‚¹ï¼š
 * - ç®¡ç†ä¸€è‡´æ€§è¾¹ç•Œ
 * - å‘å¸ƒé¢†åŸŸäº‹ä»¶
 * - ç‰ˆæœ¬æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰
 * - æ”¯æŒäº‹ä»¶æº¯æº
 */
export abstract class BaseAggregateRoot extends BaseEntity {
  private _domainEvents: BaseDomainEvent[] = [];
  private _version: number = 0;
  
  // äº‹ä»¶ç®¡ç†
  addDomainEvent(event: BaseDomainEvent): void;
  getUncommittedEvents(): readonly BaseDomainEvent[];
  markEventsAsCommitted(): void;
  
  // ç‰ˆæœ¬æ§åˆ¶
  get version(): number;
  incrementVersion(): void;
}
```

#### BaseValueObject - åŸºç¡€å€¼å¯¹è±¡

```typescript
/**
 * åŸºç¡€å€¼å¯¹è±¡
 * 
 * ç‰¹ç‚¹ï¼š
 * - ä¸å¯å˜
 * - ç›¸ç­‰æ€§åŸºäºå€¼
 * - æ— æ ‡è¯†ç¬¦
 * - å°è£…éªŒè¯é€»è¾‘
 */
export abstract class BaseValueObject {
  equals(other: BaseValueObject): boolean;
  validate(): void;
  toJSON(): Record<string, unknown>;
}
```

### 5.2 åº”ç”¨å±‚æ ¸å¿ƒç»„ä»¶

#### CQRS æ€»çº¿

```typescript
// å‘½ä»¤æ€»çº¿ - å¤„ç†å†™æ“ä½œ
export class CommandBus {
  execute<TCommand>(command: TCommand): Promise<void>;
  registerHandler(type: string, handler: ICommandHandler): void;
}

// æŸ¥è¯¢æ€»çº¿ - å¤„ç†è¯»æ“ä½œ
export class QueryBus {
  execute<TQuery, TResult>(query: TQuery): Promise<TResult>;
  registerHandler(type: string, handler: IQueryHandler): void;
}

// äº‹ä»¶æ€»çº¿ - å¤„ç†äº‹ä»¶
export class EventBus {
  publish<TEvent>(event: TEvent): Promise<void>;
  publishAll(events: TEvent[]): Promise<void>;
  registerHandler(type: string, handler: IEventHandler): void;
}

// CQRS æ€»çº¿ - ç»Ÿä¸€æ¥å£
export class CQRSBus {
  executeCommand(command: ICommand): Promise<void>;
  executeQuery<TResult>(query: IQuery): Promise<TResult>;
  publishEvent(event: IDomainEvent): Promise<void>;
}
```

#### ç”¨ä¾‹æ¥å£

```typescript
export interface IUseCase<TRequest, TResponse> {
  execute(request: TRequest): Promise<TResponse>;
  getUseCaseName(): string;
  getUseCaseDescription(): string;
}
```

### 5.3 åŸºç¡€è®¾æ–½å±‚æ ¸å¿ƒç»„ä»¶

#### ä»“å‚¨æ¥å£

```typescript
export interface IRepository<T extends BaseAggregateRoot> {
  save(aggregate: T): Promise<void>;
  findById(id: EntityId): Promise<T | null>;
  findAll(): Promise<T[]>;
  delete(id: EntityId): Promise<void>;
}
```

#### äº‹ä»¶å­˜å‚¨

```typescript
export interface IEventStore {
  saveEvents(aggregateId: string, events: DomainEvent[]): Promise<void>;
  getEvents(aggregateId: string, fromVersion?: number): Promise<DomainEvent[]>;
  saveSnapshot(snapshot: IAggregateSnapshot): Promise<void>;
  getSnapshot(aggregateId: string): Promise<IAggregateSnapshot | null>;
}
```

---

## 6. è®¾è®¡åŸåˆ™

### 6.1 SOLID åŸåˆ™

#### S - å•ä¸€èŒè´£åŸåˆ™ (SRP)

æ¯ä¸ªç±»åªæœ‰ä¸€ä¸ªæ”¹å˜çš„ç†ç”±ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šå•ä¸€èŒè´£
class UserValidator {
  validate(user: User): void { /* åªè´Ÿè´£éªŒè¯ */ }
}

class UserRepository {
  save(user: User): Promise<void> { /* åªè´Ÿè´£æŒä¹…åŒ– */ }
}

// âŒ ä¸å¥½çš„åšæ³•ï¼šå¤šé‡èŒè´£
class UserService {
  validate(user: User): void { /* éªŒè¯ */ }
  save(user: User): Promise<void> { /* æŒä¹…åŒ– */ }
  sendEmail(user: User): Promise<void> { /* å‘é‚®ä»¶ */ }
}
```

#### O - å¼€é—­åŸåˆ™ (OCP)

å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šé€šè¿‡ç»§æ‰¿æ‰©å±•
abstract class BaseNotificationService {
  abstract send(message: string): Promise<void>;
}

class EmailNotificationService extends BaseNotificationService {
  async send(message: string): Promise<void> {
    // å‘é€é‚®ä»¶
  }
}

class SmsNotificationService extends BaseNotificationService {
  async send(message: string): Promise<void> {
    // å‘é€çŸ­ä¿¡
  }
}
```

#### L - é‡Œæ°æ›¿æ¢åŸåˆ™ (LSP)

å­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šå­ç±»è¡Œä¸ºä¸€è‡´
class BaseEntity {
  equals(other: BaseEntity): boolean {
    return this.id.equals(other.id);
  }
}

class User extends BaseEntity {
  // ä¿æŒç›¸åŒçš„è¡Œä¸ºå¥‘çº¦
  equals(other: User): boolean {
    return super.equals(other);
  }
}
```

#### I - æ¥å£éš”ç¦»åŸåˆ™ (ISP)

å®¢æˆ·ç«¯ä¸åº”ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šå°è€Œä¸“æ³¨çš„æ¥å£
interface IReadRepository<T> {
  findById(id: EntityId): Promise<T | null>;
  findAll(): Promise<T[]>;
}

interface IWriteRepository<T> {
  save(aggregate: T): Promise<void>;
  delete(id: EntityId): Promise<void>;
}

// ç»„åˆæ¥å£
interface IRepository<T> extends IReadRepository<T>, IWriteRepository<T> {}
```

#### D - ä¾èµ–å€’ç½®åŸåˆ™ (DIP)

ä¾èµ–æŠ½è±¡ï¼Œä¸ä¾èµ–å…·ä½“ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šä¾èµ–æ¥å£
class CreateUserUseCase {
  constructor(
    private readonly userRepository: IUserRepository  // æ¥å£
  ) {}
}

// âŒ ä¸å¥½çš„åšæ³•ï¼šä¾èµ–å…·ä½“ç±»
class CreateUserUseCase {
  constructor(
    private readonly userRepository: PostgresUserRepository  // å…·ä½“ç±»
  ) {}
}
```

### 6.2 DDD åŸåˆ™

#### å……è¡€æ¨¡å‹ (Rich Domain Model)

ä¸šåŠ¡é€»è¾‘åœ¨é¢†åŸŸå¯¹è±¡å†…ï¼š

```typescript
// âœ… å¥½çš„åšæ³•ï¼šå……è¡€æ¨¡å‹
class Order extends BaseEntity {
  cancel(): void {
    if (this.status !== OrderStatus.Pending) {
      throw new Error('Only pending orders can be cancelled');
    }
    this.status = OrderStatus.Cancelled;
    this.addDomainEvent(new OrderCancelledEvent(this.id));
  }
}

// âŒ ä¸å¥½çš„åšæ³•ï¼šè´«è¡€æ¨¡å‹
class Order {
  status: OrderStatus;
  // æ²¡æœ‰ä¸šåŠ¡æ–¹æ³•
}

class OrderService {
  cancel(order: Order): void {
    // ä¸šåŠ¡é€»è¾‘åœ¨æœåŠ¡å±‚
    if (order.status !== OrderStatus.Pending) {
      throw new Error('Only pending orders can be cancelled');
    }
    order.status = OrderStatus.Cancelled;
  }
}
```

#### èšåˆè®¾è®¡åŸåˆ™

```
1. å°èšåˆåŸåˆ™
   - èšåˆåº”è¯¥å°½å¯èƒ½å°
   - åªåŒ…å«çœŸæ­£éœ€è¦å¼ºä¸€è‡´æ€§çš„å¯¹è±¡
   - å‡å°‘å¹¶å‘å†²çª

2. é€šè¿‡ ID å¼•ç”¨
   - èšåˆé—´é€šè¿‡ ID å¼•ç”¨
   - ä¸ç›´æ¥æŒæœ‰å…¶ä»–èšåˆçš„å¼•ç”¨
   - é¿å…çº§è”åŠ è½½

3. æœ€ç»ˆä¸€è‡´æ€§
   - è·¨èšåˆæ“ä½œä½¿ç”¨äº‹ä»¶
   - æ¥å—æœ€ç»ˆä¸€è‡´æ€§
   - ä½¿ç”¨ Saga å¤„ç†å¤æ‚æµç¨‹
```

---

## 7. æŠ€æœ¯æ ˆ

### 7.1 æ ¸å¿ƒæŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| TypeScript | 5.0+ | ç±»å‹å®‰å…¨çš„å¼€å‘è¯­è¨€ |
| NestJS | 11.1+ | ä¾èµ–æ³¨å…¥å’Œæ¨¡å—åŒ–æ¡†æ¶ |
| RxJS | 7.8+ | å“åº”å¼ç¼–ç¨‹ |
| class-validator | 0.14+ | æ•°æ®éªŒè¯ |
| class-transformer | 0.5+ | å¯¹è±¡è½¬æ¢ |

### 7.2 é›†æˆæ¨¡å—

| æ¨¡å— | ç”¨é€” |
|------|------|
| @hl8/multi-tenancy | å¤šç§Ÿæˆ·æ¶æ„æ”¯æŒ |
| @hl8/cache | ç¼“å­˜ç®¡ç† |
| @hl8/logger | æ—¥å¿—è®°å½• |
| @hl8/config | é…ç½®ç®¡ç† |
| @hl8/database | æ•°æ®åº“è®¿é—® |
| @hl8/messaging | æ¶ˆæ¯é˜Ÿåˆ— |
| @hl8/fastify-pro | Web æ¡†æ¶ |
| @hl8/common | é€šç”¨å·¥å…· |

---

## 8. æ¶æ„å›¾

### 8.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    External Clients                          â”‚
â”‚            (Web, Mobile, API, CLI, WebSocket)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Interface Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   REST   â”‚  â”‚ GraphQL  â”‚  â”‚WebSocket â”‚  â”‚   CLI    â”‚   â”‚
â”‚  â”‚Controllerâ”‚  â”‚ Resolver â”‚  â”‚ Gateway  â”‚  â”‚ Command  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Guards & Middleware & Decorators                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Commands/Queries/Events
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Application Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Use Cases    â”‚  â”‚  Command/Query â”‚  â”‚  Event/Saga    â”‚â”‚
â”‚  â”‚                â”‚  â”‚    Handlers    â”‚  â”‚    Handlers    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           CommandBus / QueryBus / EventBus           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Domain Interfaces
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Domain Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Entities â”‚  â”‚Aggregatesâ”‚  â”‚  Value   â”‚  â”‚  Domain  â”‚   â”‚
â”‚  â”‚          â”‚  â”‚   Roots  â”‚  â”‚ Objects  â”‚  â”‚  Events  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Domain  â”‚  â”‚Repositoryâ”‚  â”‚ Business â”‚                  â”‚
â”‚  â”‚ Services â”‚  â”‚Interface â”‚  â”‚  Rules   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Implementations
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Infrastructure Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Repositoryâ”‚  â”‚ Database â”‚  â”‚  Cache   â”‚  â”‚  Event   â”‚   â”‚
â”‚  â”‚   Impl   â”‚  â”‚ Adapter  â”‚  â”‚ Adapter  â”‚  â”‚  Store   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Message  â”‚  â”‚External  â”‚  â”‚ Mappers  â”‚                  â”‚
â”‚  â”‚  Queue   â”‚  â”‚ Services â”‚  â”‚          â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 CQRS æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CQRS Pattern                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‘½ä»¤ç«¯ (Write Side)           æŸ¥è¯¢ç«¯ (Read Side)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Commands     â”‚            â”‚     Queries     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CommandHandler â”‚            â”‚  QueryHandler   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Aggregate Root â”‚            â”‚   Read Model    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â”‚ Domain Events                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   EventBus      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ EventHandlers   â”‚
           â”‚   Projectors    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 äº‹ä»¶æº¯æºæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Event Sourcing Pattern                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Commands                  Events                State
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Created  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Version 1â”‚
â”‚  User    â”‚            â”‚  Event   â”‚          â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ Update   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Updated  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
â”‚  Email   â”‚            â”‚  Event   â”‚          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ Version 2â”‚
                                              â”‚          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
â”‚Deactivateâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Deactivateâ”‚               â”‚
â”‚  User    â”‚            â”‚   Event  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                              â”‚ Version 3â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Event Store (äº‹ä»¶å­˜å‚¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Aggregate: User-123                    â”‚
â”‚  â”œâ”€ V1: UserCreatedEvent                â”‚
â”‚  â”œâ”€ V2: UserEmailUpdatedEvent           â”‚
â”‚  â””â”€ V3: UserDeactivatedEvent            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

State Reconstruction (çŠ¶æ€é‡å»º)
Event Stream â”€â”€â–¶ Apply Events â”€â”€â–¶ Current State
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æ¶æ„è®¾è®¡æ–‡æ¡£

- [01-domain-layer.md](01-domain-layer.md) - é¢†åŸŸå±‚è®¾è®¡
- [02-application-layer.md](02-application-layer.md) - åº”ç”¨å±‚è®¾è®¡
- [03-infrastructure-layer.md](03-infrastructure-layer.md) - åŸºç¡€è®¾æ–½å±‚è®¾è®¡
- [04-interface-layer.md](04-interface-layer.md) - æ¥å£å±‚è®¾è®¡
- [05-cqrs-pattern.md](05-cqrs-pattern.md) - CQRS æ¨¡å¼è®¾è®¡
- [06-event-sourcing.md](06-event-sourcing.md) - äº‹ä»¶æº¯æºè®¾è®¡
- [07-multi-tenancy.md](07-multi-tenancy.md) - å¤šç§Ÿæˆ·æ¶æ„è®¾è®¡

### ä½¿ç”¨æŒ‡å—

- [Getting Started](../guides/getting-started.md) - å¿«é€Ÿå¼€å§‹
- [Entity Design](../guides/entity-design.md) - å®ä½“è®¾è®¡æŒ‡å—
- [Aggregate Design](../guides/aggregate-design.md) - èšåˆæ ¹è®¾è®¡æŒ‡å—
- [CQRS Guide](../guides/cqrs-guide.md) - CQRS ä½¿ç”¨æŒ‡å—
- [Testing Guide](../guides/testing.md) - æµ‹è¯•æŒ‡å—

---

**æ–‡æ¡£ç»´æŠ¤**: HL8 æ¶æ„å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-01-27  
**ç‰ˆæœ¬**: 1.0.0
